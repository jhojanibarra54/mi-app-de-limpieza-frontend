import{a as q}from"./chunk-GFTWP3VO.js";import"./chunk-HEXEI4CB.js";import{$ as D,A as C,F as s,G as S,H as F,I,J as y,K as E,L as w,M as B,N,Q as M,S as T,T as U,U as L,V as k,W as G,_ as x,ca as H,da as P,e as g,fa as _,g as f,k as n,l as c,n as h,o as d,p as i,q as r,r as l,s as b,t as p,u as v}from"./chunk-BKGTBVKK.js";import"./chunk-LJMIX235.js";import"./chunk-CBEOSJTC.js";import"./chunk-HVK7QFVP.js";import"./chunk-5JIQGJOD.js";import"./chunk-PGY34PD4.js";import"./chunk-GYLY2RJE.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-DVVH2KKN.js";import"./chunk-NV3QH4JK.js";import"./chunk-REYR55MP.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import{g as u}from"./chunk-2R6CW7ES.js";var Y=(()=>{let o=class o{constructor(){this.authService=n(q),this.router=n(C),this.fb=n(w),this.toastCtrl=n(P),this.loadingCtrl=n(H),this.loginForm=this.fb.group({email:["",[s.required,s.email]],password:["",[s.required]]})}onLogin(){return u(this,null,function*(){if(this.loginForm.invalid)return;document.activeElement instanceof HTMLElement&&document.activeElement.blur();let a=yield this.loadingCtrl.create({message:"Iniciando sesi\xF3n..."});yield a.present(),this.authService.login(this.loginForm.value).subscribe({next:t=>{this.authService.getIsAuthenticated().pipe(g(e=>e===!0),f(1)).subscribe(()=>{a.dismiss();let e=t.user.role;e==="cleaner"?this.router.navigateByUrl("/cleaner-home",{replaceUrl:!0}):e==="admin"?this.router.navigateByUrl("/admin-approvals",{replaceUrl:!0}):this.router.navigateByUrl("/user-home",{replaceUrl:!0})})},error:t=>u(this,null,function*(){a.dismiss(),yield(yield this.toastCtrl.create({message:t.error.message||"Error al iniciar sesi\xF3n.",duration:3e3,color:"danger"})).present()})})})}};o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=h({type:o,selectors:[["app-login"]],decls:14,vars:2,consts:[["slot","start"],["defaultHref","/welcome"],[1,"ion-padding"],[3,"ngSubmit","formGroup"],["label","Correo electr\xF3nico","labelPlacement","floating","formControlName","email","type","email","inputmode","email"],["label","Contrase\xF1a","labelPlacement","floating","formControlName","password","type","password"],["type","submit","expand","block",1,"ion-margin-top",3,"disabled"]],template:function(t,e){t&1&&(i(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),l(3,"ion-back-button",1),r(),i(4,"ion-title"),p(5,"Iniciar Sesi\xF3n"),r()()(),i(6,"ion-content",2)(7,"form",3),b("ngSubmit",function(){return e.onLogin()}),i(8,"ion-item"),l(9,"ion-input",4),r(),i(10,"ion-item"),l(11,"ion-input",5),r(),i(12,"ion-button",6),p(13," Entrar "),r()()()),t&2&&(c(7),d("formGroup",e.loginForm),c(5),d("disabled",e.loginForm.invalid))},dependencies:[k,D,U,M,x,L,G,_,T,v,N,I,S,F,y,E,B],encapsulation:2});let m=o;return m})();export{Y as LoginPage};
